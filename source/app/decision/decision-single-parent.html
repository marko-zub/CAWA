<!-- TODO: make as nested route -->
<div class="app-container-sm">
    <div class="row">
        <div class="col-sm-9">
            <h3 class="app-title-inline" ng-bind="::vm.decision.name"></h3>
            <div class="post-header">
                <div class="nav-tabs-wrapper clearfix">
                    <ul class="nav nav-tabs nav-tabs-sm">
                        <li>
                            <a ui-sref="decisions.single(::{id:vm.decision.id, slug:vm.decision.nameSlug, size: null, page: null})" ui-sref-opts="{reload: true}" translate-cloak>{{ 'General Info' | translate }}</a>
                        </li>
                        <li ng-repeat="parent in vm.decisionParents track by $index" ui-sref-active="active">
                            <a ui-sref="decisions.single.parent(::{parentId:parent.id, parentSlug:parent.nameSlug})">{{ ::parent.name }}</a>
                        </li>
                        <li>
                            <a ui-sref="decisions.single.reviews" translate-cloak>{{ 'Reviews' | translate }}</a>
                        </li>
                        <li>
                            <a ui-sref="decisions.single.options" translate-cloak>{{ 'Options' | translate }}</a>
                        </li>
                        <li>
                            <a ui-sref="decisions.single.nominations({tab: null})" translate-cloak>{{ 'Nominations' | translate }}</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="post post-single">
                <div class="post-sub-header">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="clearfix">
                                <div class="pull-right">
                                    <a ui-sref="decisions.single.options(::{id: vm.parent.id, slug: vm.parent.nameSlug})" translate-cloak>
                                        {{ 'See All' | translate }} {{ ::vm.parent.name }}
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-6">

                        <div class="clearfix" ng-show="vm.criteriaGroups">
                            <h4 class="app-list-title pull-left" translate-cloak>{{ 'Criteria compliance' | translate }}</h4>
                            

                            <div ng-switch="vm.decision.criteriaCompliancePercentage >= 0 && vm.criteriaGroups.totalVotes > 0">
                                <div ng-switch-when="true" class="criteria-block static pull-right">
                                    <div class="counters">
                                        <strong ng-bind="vm.decision.criteriaCompliancePercentage"></strong>%
                                    </div>
                                    <div class="counters criteria-block-votes">
                                        <i class="app-icon glyphicon glyphicon-thumbs-up"></i>
                                        {{ vm.criteriaGroups.totalVotes }}
                                    </div>
                                    <div ng-if="vm.decision.criteriaCompliancePercentage >= 0" class="criteria-block-rating">
                                        <rating-star class="text-left" percentage="::vm.decision.criteriaCompliancePercentage"></rating-star>
                                    </div>                                
                                </div>
                                <div ng-switch-when="false" class="pull-right mt-1">
                                    <a href="#" translate-cloak>{{ "RATE IT" | translate }}</a>
                                </div>

                            </div>                            
                        </div>
                        
                        <div class="list-wrapper">
                            <div ng-show="vm.criteriaGroupsLoader" class="app-loader-small"><span class="glyphicon glyphicon-refresh app-loader-animation"></span></div>
                            
                            <criteria-list ng-if="vm.criteriaGroups" list="vm.criteriaGroups" links="false" rating="true" criteria-title="false" discussion="true" collapsed="false"></criteria-list>                            

                        </div>

                    </div>
                    <div class="col-sm-6">
                        <div class="list-wrapper">
                            <div ng-show="vm.characteristicGroupsLoader" class="app-loader-small"><span class="glyphicon glyphicon-refresh app-loader-animation"></span></div>

                            <characteristics-list ng-if="vm.characteristicGroups" list="vm.characteristicGroups" links="false" rating="true" discussion="true" collapsed="false"></characteristics-list>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- TODO: move to component -->
        <!-- Recommended Start -->
        <div class="col-sm-3 recommended-list" ng-if="vm.decisionParents.length">
            <h4>{{ "Recommended" | translate }}</h4>

            <div class="nav-tabs-wrapper tabs-left">
                <ul class="nav nav-tabs nav-tabs-sm">
                    <li ng-repeat="parent in vm.decisionParents track by $index" ng-class="{'active':vm.activeRecommendedTab.id === parent.id}">
                        <a ng-click="vm.getRecommendedDecisions(vm.decision.id, parent)"> {{::parent.name}}</a>
                    </li>
                </ul>
                <div class="pull-right text-header">
                    <a ui-sref="decisions.single.options(::{id:vm.activeRecommendedTab.id, slug:vm.activeRecommendedTab.nameSlug, size: null, page: null, tab: null})" class="see-all">
                        {{ 'See All' | translate }} <span class="info">({{vm.activeRecommendedTab.total || 0}})</span>
                    </a>
                </div>
            </div>

            <decisions-list class-name="'cards'" compare="true" list="vm.recommendedDecisionsList" criteria-groups-list="vm.criteriaGroups" criteria-list="true" parent-decision="vm.activeRecommendedTab"></decisions-list>

            <div ng-show="vm.recommendedDecisionsListLoader" class="app-loader-small"><span class="glyphicon glyphicon-refresh app-loader-animation"></span></div>

        </div>
        <!-- End Recommended Start -->

    </div>

</div>
