<!-- TODO: make as nested route -->
<div class="app-container-sm">
    <div class="row">
        <div class="col-sm-9">
            <h3 class="app-title-inline" ng-bind="::vm.decision.name"></h3>
            <div class="post-header">
                <div class="nav-tabs-wrapper clearfix">
                    <ul class="nav nav-tabs nav-tabs-sm">
                        <li>
                            <a ui-sref="decisions.single(::{id:vm.decision.id, slug:vm.decision.nameSlug, size: null, page: null})" ui-sref-opts="{reload: true}" translate-cloak>{{ 'General Info' | translate }}</a>
                        </li>
                        <li class="active">
                            <a href="#" translate-cloak>{{ 'CHARACTERISTICS' | translate }}</a>
                        </li>                        
<!--                         <li ng-repeat="parent in vm.ParentDecisionGroups track by $index" ui-sref-active="active">
                            <a ui-sref="decisions.single.characteristics(::{parentId:parent.id, parentSlug:parent.nameSlug})">{{ ::parent.ownerDecision.name }}/{{ ::parent.name }}</a>
                        </li> -->
                        <li>
                            <a ui-sref="decisions.single.reviews" translate-cloak>{{ 'Reviews' | translate }}</a>
                        </li>
                        <li>
                            <a ui-sref="decisions.single.categories({category: null})" translate-cloak>{{ 'CATEGORIES' | translate }}</a>
                        </li>
                        <li>
                            <a ui-sref="decisions.single.nominations({sort: null})" translate-cloak>{{ 'Nominations' | translate }}</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="post post-single">

                <div ng-if="vm.decision.parentDecisionGroups.length">
                        

     <!--                <pre>
                        {{ vm.decision.parentDecisionGroups | json }}
                    </pre>
 -->

                    
                    <div class="nav-tabs-wrapper mg-b-md tabs-left clearfix">
                        <ul class="nav nav-tabs nav-tabs-sm">
                            <li ng-repeat="parentDecision in vm.decision.parentDecisionGroups track by $index" ng-class="{'active':parentDecision.ownerDecision.nameSlug === vm.parent.ownerDecision.nameSlug}">
                                <a ui-sref="decisions.single.characteristics(::{characteristicSlug:parentDecision.ownerDecision.nameSlug, category: null})" ui-sref-opts="{notify: false}" ng-click="vm.changeCategoryTab(parentDecision.ownerDecision.nameSlug)">{{ parentDecision.ownerDecision.name }}</a>

                            </li>
                        </ul>
                    </div>


                    <div class="nav-tabs-wrapper border-0 clearfix tabs-right">
                        <ul class="nav nav-pills nav-tabs-sm">
                            <li ng-repeat="parent in vm.ParentDecisionGroups track by $index" ng-class="{'active': parent.nameSlug === vm.parent.nameSlug }">
                                <a ui-sref="decisions.single.characteristics(::{sort: null, category: parent.nameSlug, characteristicSlug:parent.ownerDecision.nameSlug})" >{{ ::parent.name }}</a>
                            </li>
                        </ul>
                    </div>

                </div>

                <div ng-if="vm.parent">
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="clearfix">
                                <h5 ng-show="vm.decisionIndexInParentGroup >= 0" class="pull-left">
                                    <a ui-sref="decisions.single.categories(::{id: vm.parent.id, slug: vm.parent.ownerDecision.nameSlug, size: null, page: null, sort: 'topRated', page: vm.decisionIndexInParentGroupPage, size: 10, categorySlug: vm.parent.nameSlug, decisionId: vm.decision.id})">
                                    <strong>#{{ vm.decisionIndexInParentGroup }}</strong></a> 
                                        {{ 'IN' | translate }} {{ vm.parent.name }}
                                </h5> 
                                <div class="pull-right text-header" ng-if="vm.activeRecommendedTab.total >= 0">
                                    <a ui-sref="decisions.single.categories(::{id: vm.parent.id, slug: vm.parent.ownerDecision.nameSlug, size: null, page: null, sort: 'topRated', categorySlug: vm.parent.nameSlug})" class="see-all">
                                        {{ 'See All' | translate }} <span class="info">({{vm.activeRecommendedTab.total}})</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6">

                            <div class="clearfix" ng-show="vm.criteriaGroups">

                                <h4 class="app-list-title pull-left" translate-cloak>{{ 'CRITERIA COMPLIANCE' | translate }}</h4>
                                <div ng-switch="vm.decision.criteriaCompliancePercentage >= 0 && vm.criteriaGroups.totalVotes > 0">
                                    <div ng-switch-when="true" class="criteria-block static pull-right">
                                        <div class="counters">
                                            <strong ng-bind="vm.decision.criteriaCompliancePercentage"></strong>%
                                        </div>
                                        <div class="counters criteria-block-votes">
                                            <i class="app-icon glyphicon glyphicon-thumbs-up"></i>
                                            {{ vm.criteriaGroups.totalVotes }}
                                        </div>
                                        <div ng-if="vm.decision.criteriaCompliancePercentage >= 0" class="criteria-block-rating">
                                            <rating-star class="text-left" percentage="::vm.decision.criteriaCompliancePercentage"></rating-star>
                                        </div>
                                    </div>
                      

                                </div>
                            </div>

                            <div class="list-wrapper">
                                <div ng-show="vm.criteriaGroupsLoader" class="app-loader-small"><span></span></div>

                                <criteria-list ng-if="vm.criteriaGroups" list="vm.criteriaGroups" links="false" rating="true" criteria-title="false" discussion="true" discussion-link="false" collapsed="false"></criteria-list>

                            </div>

                        </div>
                        <div class="col-sm-6">
                            <div class="list-wrapper">
                                <div ng-show="vm.characteristicGroupsLoader" class="app-loader-small"><span></span></div>

                                <characteristics-list ng-if="vm.characteristicGroups" list="vm.characteristicGroups" links="false" rating="true" discussion="true" discussion-link="false" collapsed="false"></characteristics-list>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- TODO: move to component -->
        <!-- Recommended Start -->
        <div class="col-sm-3 recommended-list" ng-if="vm.ParentDecisionGroups.length">
            <h4>{{ "Recommended" | translate }}</h4>

            <div class="nav-tabs-wrapper tabs-left">
                <ul class="nav nav-tabs nav-tabs-sm">
                    <li ng-repeat="parent in vm.ParentDecisionGroups track by $index" ng-class="{'active':vm.activeRecommendedTab.id === parent.id}">
                        <a ng-click="vm.getRecommendedDecisions(vm.decision.id, parent)">{{ ::parent.ownerDecision.name }}/{{::parent.name}}</a>
                    </li>
                </ul>
                <div class="pull-right text-header">
                    <a ui-sref="decisions.single.categories(::{id:vm.activeRecommendedTab.id, slug:vm.activeRecommendedTab.nameSlug, size: null, page: null, sort: null, category: null})" class="see-all">
                        {{ 'See All' | translate }} <span class="info">({{vm.activeRecommendedTab.total || 0}})</span>
                    </a>
                </div>
            </div>

            <decisions-list class-name="'cards'" compare="true" list="vm.recommendedDecisionsList" criteria-groups-list="vm.criteriaGroups" criteria-list="true" parent-decision="vm.activeRecommendedTab"></decisions-list>

            <div ng-show="vm.recommendedDecisionsListLoader" class="app-loader-small"><span></span></div>

        </div>
        <!-- End Recommended Start -->

    </div>

</div>
