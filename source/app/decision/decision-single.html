<div class="app-container-sm">
    <div class="row">
        <div class="col-sm-12">
            <div class="app-title-table">
                <div class="app-title-table-img" ng-if="::vm.decision.imageUrl">
                    <div class="post-image post-image-title">
                        <img ng-src="{{::vm.decision.imageUrl}}" class="img-responsive">
                        <div ng-bind="vm.decision.imageBlock"> </div>
                    </div>
                </div>
                <div class="app-title-table-title">
                    <h3 class="app-title-inline" ng-bind="::vm.decision.name"></h3>
                </div>
            </div>

            <div class="post-header">
                <app-votes></app-votes>
                <div class="nav-tabs-wrapper">
                    <ul class="nav nav-tabs nav-tabs-sm">
                        <li class="active">
                            <a ui-sref="decisions.single(::{id:vm.decision.id, slug:vm.decision.nameSlug, size: null, page: null, sort: null, category: null})" translate-cloak>{{ 'General Info' | translate }}</a>
                        </li>
                        <li>
                            <a ui-sref="decisions.single.characteristics(::{sort: null, category: null})" translate-cloak>{{ 'CHARACTERISTICS' | translate }}</a>
                        </li>
                        <li>
                            <a ui-sref="decisions.single.reviews({sort: null, category: null})" translate-cloak>{{ 'Reviews' | translate }}</a>
                        </li>
                        <li>
                            <a ui-sref="decisions.single.categories({sort: null, category: null})" translate-cloak>{{ 'CATEGORIES' | translate }}</a>
                        </li>
                        <li>
                            <a ui-sref="decisions.single.nominations({sort: null, category: null})" translate-cloak>{{ 'Nominations' | translate }}</a>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="post-sub-header">
                <div class="row">
                    <div class="col-sm-7">
                        <decision-short-info decision="::vm.decision"></decision-short-info>
                    </div>
                    <div class="col-sm-5 text-right">
                        <div class="inline-block">
                            <div>
                                <media-links list="vm.decision.medias"></media-links>
                            </div>
                            <div>
                                <compare-button decision="vm.decision" parent-decision="vm.parentDecisionGroups[0]"></compare-button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-sm-12">
            <div class="post post-single with-rating">
                <div class="clearfix text-justify">
                    <div class="page-description" ng-bind-html="::vm.decision.description" translate translate-cloak></div>
                </div>

                <!-- Gallery -->
                <media list="vm.decision.medias"></media>
                <!-- End Gallery -->
            </div>
        </div>


        <div class="col-sm-12" ng-if="vm.parentDecisionGroups.length">
            <div class="nav-tabs-wrapper tabs-left mg-b-sm">
                <ul class="nav nav-tabs nav-tabs-sm">
                    <li ng-repeat="parent in vm.parentDecisionGroups track by $index" ng-class="{'active':vm.activeParentTab.id === parent.id}">
                        <a ng-click="vm.getParentDecisions(parent)">
                        {{ ::parent.ownerDecision.name }}</a>
                    </li>
                </ul>
            </div>
            <div class="nav-tabs-wrapper border-0 clearfix tabs-right mg-b-sm">

                <a class="nav-tabs-wrapper-link" ui-sref="decisions.single({id:vm.activeParentTab.ownerDecision.id, slug: vm.activeParentTab.ownerDecision.nameSlug})">
                Read More About {{ vm.activeParentTab.ownerDecision.name }}
            </a>

                <ul class="nav nav-pills nav-tabs-sm">
                    <li ng-repeat="child in vm.activeParentTab.ownerDecision.decisionGroups track by child.id" ng-class="{'active':vm.activeChildTab.id === child.id}">
                        <a ng-click="vm.getChildDecisions(child)">{{ ::child.name }}</a>
                    </li>
                </ul>
            </div>
        </div>


        <div class="col-sm-9">

            <history-chart characteristics="vm.characteristicGroupsChart" decision="vm.decision"></history-chart>

            <decisions-wrapper decision="::vm.decision" on-change-tab="vm.onChangeTab(tab);"></decisions-wrapper>

        </div>
        <div class="col-sm-3">
            <!-- Parent criteria & characteristics -->
            <div class="decision-aside" ng-if="vm.parentDecisionGroups.length">
                <div class="clearfix mg-b-sm" ng-show="vm.criteriaGroupsCompilance">
                    <!-- Make as component -->
                    <div class="clearfix">
                        <h5 ng-show="vm.decisionIndexInParentGroup >= 0" class="pull-left">
                            <a ui-sref="decisions.single.categories({id: vm.activeParentTab.ownerDecision.id, slug: vm.activeParentTab.ownerDecision.nameSlug, size: null, page: null, category: null, sort: 'topRated', page: vm.decisionIndexInParentGroupPage, size: 10, categorySlug: vm.activeParentTab.nameSlug, decisionId: vm.decision.id})">
                            <strong>#{{ vm.decisionIndexInParentGroup }}</strong></a>
                                {{ 'IN' | translate }} {{ vm.activeParentTab.name }}
                        </h5>
                        <div class="pull-left text-header">
                            <a ui-sref="decisions.single.categories({id: vm.activeParentTab.ownerDecision.id, slug: vm.activeParentTab.ownerDecision.nameSlug, size: null, page: null, sort: 'topRated', categorySlug: vm.activeParentTab.nameSlug})" class="see-all">
                                {{ 'See All' | translate }} <span class="info">({{ vm.activeParentTab.totalChildDecisions }})</span>
                            </a>
                        </div>
                    </div>
                    <h4 class="app-list-title pull-left" translate-cloak>{{ 'CRITERIA COMPLIANCE' | translate }}</h4>
                    <div ng-switch="vm.decision.criteriaCompliancePercentage >= 0 && vm.criteriaGroupsCompilance.totalVotes > 0">
                        <div ng-switch-when="true" class="criteria-block static pull-right">
                            <div class="counters percentage">
                                <strong ng-bind="vm.decision.criteriaCompliancePercentage"></strong>%
                            </div>
                            <div class="counters criteria-block-votes">
                                <i class="dw-icon-vote"></i> {{ vm.criteriaGroupsCompilance.totalVotes }}
                            </div>
                            <div ng-if="vm.decision.criteriaCompliancePercentage >= 0" class="criteria-block-rating">
                                <rating-star class="text-left" percentage="::vm.decision.criteriaCompliancePercentage"></rating-star>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="list-wrapper sm" ng-show="vm.criteriaGroupsCompilanceInit">
                    <div ng-show="vm.criteriaGroupsLoader" class="app-loader-small"><span></span></div>
                    <criteria-list ng-if="vm.criteriaGroupsCompilance" list="vm.criteriaGroupsCompilance" links="false" rating="true" crteria-title="false" discussion="true" discussion-link="false" collapsed="false"></criteria-list>
                </div>
                <div class="list-wrapper sm" ng-show="vm.characteristicGroupsInit">
                    <div ng-show="vm.characteristicGroupsLoader" class="app-loader-small"><span></span></div>
                    <characteristics-list ng-if="vm.characteristicGroups" list="vm.characteristicGroups" links="false" rating="true" discussion="false" collapsed="false"></characteristics-list>
                </div>
            </div>
            <!-- End Parent criteria & characteristics -->
            <!-- Owners -->
            <owner-users list="vm.decision.ownerUsers" become-title="vm.decision.name"></owner-users>
            <!-- End Owners -->
        </div>
    </div>
</div>