<div class="app-container-sm">
    <div class="row">
        <div class="col-sm-9">
            <!-- <div ng-class="vm.parentDecisionGroups.length ? 'col-sm-9' : 'col-sm-12'"> -->
            <h3 class="app-title-inline" ng-bind="::vm.decision.name"></h3>
            <div class="post-header">
                <app-votes></app-votes>
                <div class="nav-tabs-wrapper">
                    <ul class="nav nav-tabs nav-tabs-sm">
                        <li class="active">
                            <a ui-sref="decisions.single(::{id:vm.decision.id, slug:vm.decision.nameSlug, size: null, page: null, sort: null, category: null})" translate-cloak>{{ 'General Info' | translate }}</a>
                        </li>
                        <li>
                            <a ui-sref="decisions.single.characteristics(::{sort: null, category: null})" translate-cloak>{{ 'CHARACTERISTICS' | translate }}</a>
                        </li>
                        <li>
                            <a ui-sref="decisions.single.reviews({sort: null, category: null})" translate-cloak>{{ 'Reviews' | translate }}</a>
                        </li>
                        <li>
                            <a ui-sref="decisions.single.categories({sort: null, category: null})" translate-cloak>{{ 'CATEGORIES' | translate }}</a>
                        </li>
                        <li>
                            <a ui-sref="decisions.single.nominations({sort: null, category: null})" translate-cloak>{{ 'Nominations' | translate }}</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="post-sub-header">
                <div class="row">
                    <div class="col-sm-8">
                        <decision-short-info decision="::vm.decision"></decision-short-info>
                    </div>
                    <div class="col-sm-4">
                        <div class="pull-right">
                            <compare-button decision="vm.decision" parent-decision="vm.parentDecisionGroups[0]"></compare-button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="post post-single with-rating">
                <div class="clearfix text-justify">
                    <div class="post-image">
                        <img ng-src="{{::vm.decision.imageUrl}}" class="img-responsive">
                    </div>
                    <div class="page-description" ng-bind-html="(vm.decision.description || 'NO DESCRIPTION' | translate)" translate-cloak></div>
                </div>
                <media-links list="vm.decision.medias"></media-links>
                <!-- Gallery -->
                <media list="vm.decision.medias"></media>
                <!-- End Gallery -->
            </div>
            <div class="row decision-childs">
                <div class="col-xs-12 mg-sm-b">
                    <div class="nav-tabs-wrapper tabs-left clearfix">
                        <h4 class="tabs-title" translate-cloak>
                            {{ 'CATEGORIES' | translate }}
                        </h4>
                        <ul class="nav nav-tabs nav-tabs-sm">
                            <li ng-repeat="item in vm.decisionGroups track by $index" ng-class="{'active':vm.activeDecisionGroupsTabIndex === $index }" ng-if="vm.decisionGroups && !vm.decisionsChildsLoader">
                                <a ui-sref="decisions.single(::{category: item.nameSlug})" ui-sref-opts="{notify: false}" ng-click="vm.changeDecisionGroupsTab(item.nameSlug)">{{ item.name | translate }} ({{::item.totalChildDecisions}})
                                </a>
                            </li>
                        </ul>
                        <div class="pull-right text-header">
                            <a ui-sref="decisions.single.categories({size: null, page: null, sort: null, category: null})" class="see-all" translate-cloak>
                                {{ 'See All' | translate }}
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-xs-12" ng-if="vm.childDecisionGroups.length">
                    <div class="nav-tabs-wrapper border-0 clearfix tabs-right">
                        <ul class="nav nav-pills nav-tabs-sm">
                            <li ng-repeat="item in ::vm.navigation track by $index" ng-class="{'active':vm.activeTabSort == $index}">
                                <a ui-sref="decisions.single(::{sort:item.key})" ui-sref-opts="{notify: false}" ng-click="vm.changeOptionTab(item.key)">{{item.label}}</a>
                            </li>
                        </ul>
                    </div>
                </div>
                <!-- Tabs content -->
                <div ng-if="!vm.childDecisionGroups.length && !vm.decisionsChildsLoader">
                    <div class="col-sm-7">
                        <div class="mg-b-md app-action-text" translate-cloak>
                            {{ "NO OPTIONS" | translate }}
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 mg-sm-b">
                        <!-- <decisions-list compare="true" list="vm.childDecisionGroups" parent-decision="vm.decision"></decisions-list> -->
                        <!--              <ul class="nav nav-tabs nav-tabs-sm" ng-if="vm.isDecisionsParent && !vm.decisionsChildsLoader">
                            <li ng-repeat="item in ::vm.navigation track by $index" ng-class="{'active':vm.activeTabSort === $index }">
                                <a ui-sref="decisions.single(::{sort:item.key})" ui-sref-opts="{notify: false}" ng-click="vm.changeOptionTab(item.key)">{{ item.label | translate }}</a>
                            </li>
                        </ul> -->
                    </div>
                </div>
                <div class="col-sm-12">
                    <div ng-show="vm.childDecisionGroups.length">

                        <div class="row">
                            <div class="col-md-8">
                                <filter-bar on-change-filter="vm.changeFilter(value)"></filter-bar>
                            </div>
                            <div class="col-md-4">
                                <a ui-sref="decisions.single.categories.comparison({analysisId:null, categorySlug:vm.activeDecisionGroupsTab.nameSlug, size: null, page: null, sort: null, decisionId: null })" class="btn btn-primary-2 btn-comparison pull-right" translate-cloak>
                                    {{ 'Comparison Matrix' | translate }}
                                </a>
                            </div>
                        </div>
                        <div class="decisions-list" ng-style="{'min-height': vm.decisionsHeight}" ng-if="!vm.decisionsChildsLoader">
                            <decisions-list compare="true" list="vm.decisions" criteria-groups-list="vm.criteriaGroups" criteria-list="true" parent-decision="vm.decision"></decisions-list>
                            <app-paginator total="vm.pagination.totalDecisions" page-size="vm.pagination.pageSize" page-number="vm.pagination.pageNumber" on-change-page="vm.changePage(pagination)"></app-paginator>
                            <!-- TODO: remove second loader -->
                            <div ng-show="vm.decisionsChildsLoaderRequest" class="app-loader-small"><span></span></div>
                        </div>
                        <div ng-show="vm.isDecisionsParent && vm.decisionsChildsLoader" class="app-loader-small"><span></span></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-3">
            <!-- Parent criteria & characteristics -->
            <div class="decision-aside" ng-if="vm.parentDecisionGroups.length">
                <div class="nav-tabs-wrapper tabs-left">
                    <ul class="nav nav-tabs nav-tabs-sm">
                        <li ng-repeat="parent in vm.parentDecisionGroups track by $index" ng-class="{'active':vm.activeParentTab.index == $index}">
                            <a ng-click="vm.getParrentDecisions(vm.decision.id, parent)"> {{ ::parent.ownerDecision.name }}/{{::parent.name}}</a>
                        </li>
                    </ul>
                </div>
                <div class="clearfix" ng-show="vm.criteriaGroupsCompilance">
                    <!-- Make as component -->
                    <div class="clearfix">
                        <h5 ng-show="vm.decisionIndexInParentGroup >= 0" class="pull-left">
                            <a ui-sref="decisions.single.categories(::{id: vm.activeParentTab.id, slug: vm.activeParentTab.ownerDecision.nameSlug, size: null, page: null, sort: 'topRated', page: vm.decisionIndexInParentGroupPage, size: 10, categorySlug: vm.activeParentTab.nameSlug, decisionId: vm.decision.id})">
                            <strong>#{{ vm.decisionIndexInParentGroup }}</strong></a>
                                {{ 'IN' | translate }} {{ vm.activeParentTab.name }}
                        </h5>
                        <div class="pull-left text-header">
                            <a ui-sref="decisions.single.categories(::{id: vm.activeParentTab.id, slug: vm.activeParentTab.ownerDecision.nameSlug, size: null, page: null, sort: 'topRated', categorySlug: vm.activeParentTab.nameSlug})" class="see-all">
                                {{ 'See All' | translate }} <span class="info">({{vm.activeParentTab.totalChildDecisions}})</span>
                            </a>
                        </div>
                    </div>
                    <h4 class="app-list-title pull-left" translate-cloak>{{ 'CRITERIA COMPLIANCE' | translate }}</h4>
                    <div ng-switch="vm.decision.criteriaCompliancePercentage >= 0 && vm.criteriaGroupsCompilance.totalVotes > 0">
                        <div ng-switch-when="true" class="criteria-block static pull-right">
                            <div class="counters percentage">
                                <strong ng-bind="vm.decision.criteriaCompliancePercentage"></strong>%
                            </div>
                            <div class="counters criteria-block-votes">
                                <span class="icon-svg-vote"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M501.333 0c-25.11 0-57.024 16.128-66.475 21.205L298.668.363c-19.137 0-65.324 1.237-80.3 12.267L133.035 65.6c-4.053 2.517-5.93 7.403-4.63 11.99 1.324 4.586 5.505 7.743 10.262 7.743h96c.853 0 1.685-.107 2.517-.256l14.293-3.52c9.237-1.344 18.453 1.408 25.472 7.488 7.04 6.08 11.05 14.89 11.05 24.192 0 7.403-2.304 14.464-6.677 20.46l-33.557 46.1c-9.365 14.037-7.51 32.896 4.437 44.843 6.933 6.912 16.02 10.39 25.13 10.39s18.198-3.478 25.132-10.412l54.08-54.08c20.203-1.13 38.677-9.856 52.373-23.936 18.944 17.557 79.573 23.125 91.584 24.043.277.02.555.02.832.02 2.667 0 5.27-1.002 7.232-2.836C510.763 165.8 512 162.964 512 160V10.667C512 4.78 507.22 0 501.334 0zm-85.29 71.296l-12.31 46.7c-10.11 19.348-29.844 31.338-51.732 31.338-2.836 0-5.546 1.11-7.55 3.115l-57.09 57.087c-5.354 5.355-14.72 5.355-20.074 0-4.78-4.757-5.525-12.31-2.027-17.557l33.322-45.74c7.04-9.663 10.752-21.098 10.752-33.044 0-15.467-6.7-30.165-18.39-40.3-9.663-8.362-21.887-12.927-35.028-12.927-2.773 0-5.61.212-8.448.618L233.408 64h-57.344l54.25-33.707c6.678-4.907 36.054-8.597 66.732-8.725l126.528 19.477c-2.07 7.403-4.758 17.856-7.53 30.25zm74.624 76.97c-23.06-2.602-51.392-7.914-63.467-14.634 2.133-20.736 5.888-40.832 9.6-57.43l9.77-37.076c9.857-5.184 28.225-13.61 44.097-16.66v125.8z"/><path d="M405.163 392.917l-21.333-128c-.853-5.14-5.29-8.917-10.517-8.917H320c0-5.888-4.78-10.667-10.667-10.667s-10.667 4.78-10.667 10.667v10.56c0 .043-.02.064-.02.107s.02.064.02.107V320h-192V128H256c5.888 0 10.667-4.78 10.667-10.667s-4.78-10.667-10.667-10.667H96c-5.888 0-10.667 4.78-10.667 10.667V256H32c-5.205 0-9.664 3.776-10.517 8.917l-21.333 128c-.043.277.064.533.043.79-.022.34-.193.618-.193.96v106.667C0 507.22 4.78 512 10.667 512h384c5.888 0 10.667-4.78 10.667-10.667V394.667c0-.363-.17-.683-.213-1.024-.02-.256.085-.49.043-.726zM41.023 277.333h44.31V320H74.667C68.78 320 64 324.78 64 330.667s4.78 10.667 10.667 10.667h256c5.888 0 10.667-4.78 10.667-10.667S336.554 320 330.667 320H320v-42.667h44.288L382.058 384H23.254l17.77-106.667zM384 490.667H21.333v-85.333H384v85.333z"/></svg></span> {{ vm.criteriaGroupsCompilance.totalVotes }}
                            </div>
                            <div ng-if="vm.decision.criteriaCompliancePercentage >= 0" class="criteria-block-rating">
                                <rating-star class="text-left" percentage="::vm.decision.criteriaCompliancePercentage"></rating-star>
                            </div>
                        </div>
                        <!--                   <div ng-switch-when="false" class="pull-right mt-1">
                            <a href="#" translate-cloak>{{ "RATE IT" | translate }}</a>
                        </div> -->
                    </div>
                </div>
                <div class="list-wrapper sm">
                    <div ng-show="vm.criteriaGroupsLoader" class="app-loader-small"><span></span></div>
                    <criteria-list ng-if="vm.criteriaGroupsCompilance" list="vm.criteriaGroupsCompilance" links="false" rating="true" crteria-title="false" discussion="true" discussion-link="false" collapsed="false"></criteria-list>
                </div>
                <div class="list-wrapper sm">
                    <div ng-show="vm.characteristicGroupsLoader" class="app-loader-small"><span></span></div>
                    <characteristics-list ng-if="vm.characteristicGroups" list="vm.characteristicGroups" links="false" rating="true" discussion="false" collapsed="false"></characteristics-list>
                </div>
            </div>
            <!-- End Parent criteria & characteristics -->
            <!-- Owners -->
            <owner-users list="vm.decision.ownerUsers" become-title="vm.decision.name"></owner-users>
            <!-- End Owners -->
        </div>
    </div>
</div>