<breadcrumbs items="breadcrumbs"></breadcrumbs>
<div class="app-top-panel">
    <div class="app-container-sm">
        <div class="row">
            <div class="col-sm-6">
                <h4 class="app-header-sub-title pull-left">
                    Decission Top {{::vm.pagination.pageSize}} {{::vm.decision.name}}
                </h4>
                <rating-star ng-if="::vm.discussion.votes.weight" class="text-left pull-left" item="::vm.discussion.votes"></rating-star>
            </div>
            <div class="col-sm-6">
                <div class="pull-right">
                    <a ui-sref="decisions.single.matrix.analysis({analysisId:'hall-of-fame'})" class="btn btn-sm">Comparison Matrix Hall of Fame</a>
                    <a href class="btn btn-primary btn-sm">Ask for Decision</a>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="app-container-sm">

<!--     <pre>
        {{vm.decision | json}}
    </pre> -->
    
    <div class="post">
        
        <div class="post-header">
            <div class="nav-tabs-wrapper clearfix" ng-if="vm.decisionParents.length">
                <ul class="nav nav-tabs nav-tabs-sm">
                    <li ng-repeat="parent in vm.decisionParents track by parent.decisionId" ng-class="{'active':parent.isActive}">
                        <a ui-sref="decisions.single({id:parent.decisionId, slug:parent.nameSlug})">
                            {{::parent.name}}
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="post-sub-header">
            <div class="author">
                <i class="fa fa-user-o" aria-hidden="true"></i>
                <span ng-bind="::vm.decision.createUser.username"></span>
            </div>
            <div class="date">
                <i class="fa fa-calendar-o" aria-hidden="true"></i>
                <span ng-bind="::vm.decision.createDate | date:'MM/dd/yyyy'"></span>
            </div>
        </div>
        
        <div class="post-body">
            <p class="app-content-description" ng-if="::vm.decision.description">
                {{::vm.decision.description}}
            </p>
        </div>
    </div>

    <div class="app-content-nav">
        <div class="row" ng-if="::vm.decision.parentDecisionIds.length">
            <div class="col-sm-5 col-md-6">
                <div class="input-group top-panel-title">
                   <h5>Parent decision: </h5>
                   <div class="btn-group btn-group-sm btns-view">
                        <a ui-sref="decisions.single({id:parentDecision})" ui-sref-active="btn-primary" class="btn btn-default" ng-repeat="parentDecision in vm.decision.parentDecisionIds track by $index">{{parentDecision}}</a>
                        </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-8">
            <ul class="discussions-list">
                <li ng-repeat="decision in vm.decisions track by $index">
                    <a ui-sref="decisions.single.matrix.child({discussionId:decision.decisionId, discussionSlug:decision.nameSlug, size: null, page: null})">
                        <div class="clearfix">
                            <div class="img-container" ng-if="decision.imageUrl">
                                <img ng-src="{{decision.imageUrl}}" class="img-responsive">
                            </div>
                            <div class="pull-left">
                                {{decision.name}}
                                <div>
                                    <small>
                                        Criteria compliance: <strong ng-bind="decision.criteriaCompliancePercentage"></strong>%
                                         | <span class="app-icon glyphicon glyphicon-thumbs-up"></span> {{decision.totalVotes}}
                                    </small>
                                </div>
                            </div>
                        </div>
                    </a>
                    <div class="discussions-list-description" ng-bind-html="decision.description"></div>
                </li>
            </ul>
            <!-- TODO: use as component -->
            <div class="row app-pagination clearfix" ng-if="vm.decision.totalChildDecisions > 0">
                <div class="col-md-10 col-sm-10 paginator">
                    <div uib-pagination ng-model="vm.pagination.pageNumber" boundary-links="true" boundary-link-numbers="true" total-items="vm.pagination.totalDecisions" items-per-page="vm.pagination.pageSize" ng-change="vm.changePage()" class="pagination-sm" class="pagination-sm" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" max-size="5"></div>
                </div>
                <div class="col-md-2 col-sm-2 counter">
                    <select class="pagination form-control input-sm pull-right" ng-model="vm.pagination.pageSize" ng-options="item for item in vm.itemsPerPage" ng-change="vm.changePageSize()"></select>
                </div>
            </div>
        </div>
        <!-- Criteria -->
        <!-- TODO: make as component -->
        <div class="col-sm-4">
            <div class="app-list-panel" ng-if="vm.criteriaGroups[0].criteria.length > 0">
                <h4>Criteria</h4>
                <div class="app-list-group" ng-repeat="group in ::vm.criteriaGroups track by $index">
                    <h5>{{::group.name}}</h5>
                    <ul class="discussions-list">
                        <li ng-repeat="criteria in group.criteria | orderBy:'criterionId'" ng-class="{'selected':vm.discussion.childCriterion.criterionId === criteria.criterionId}">
                            <!-- <a ui-sref="decisions.single.matrix.child.option({critOrCharId:criteria.criterionId, critOrCharSlug:criteria.nameSlug})"> -->
                            <div class="discussions-list-content">
                                <div class="clearfix">
                                    <div class="pull-left">
                                        {{::criteria.name}}
                                    </div>
                                    <div class="pull-right app-rating-inline">
                                        <rating-star class="text-left" item="criteria" ng-show="criteria.weight"></rating-star>
                                    </div>
                                    <div class="text-right" ng-if="criteria.description">
                                        <span class="link-secondary glyphicon glyphicon-question-sign" popover-title="{{::criteria.name}}" uib-popover-html="::criteria.description" popover-placement="left" popover-append-to-body="true" popover-trigger="'outsideClick'" tabindex="0"></span>
                                    </div>
                                </div>
                            </div>
                            <!-- </a> -->
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- End Criteria -->
    </div>
</div>
